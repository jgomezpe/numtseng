<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Numtseng: Escuela de Python</title>
	<script type='text/javascript' src='../../konekti/src/konekti.js'></script> 
</head>

<body>
	<script>
		let RES_URL = "https://jgomezpe.github.io/numtseng/" // Resources are stored in github
		let SERVER_URL = "https://jgomezpe.github.io/numtseng/" // Change this to your server name

        Konekti.uses('accordion', 'sidebar','navbar', 'dropdown', 'iframe')

		class KMain extends MainClient{
			constructor(lang){
				super()
				this.page = ''
				this.lang = lang
			}

			select(page){
				var x = this
				if( x.page != page ){			
					x.page = page
					Konekti.dom.setURLSearchParam('page',page)
					Konekti.dom.setURLSearchParam('lang',x.lang)

					Konekti.resource.JSON(RES_URL+'python/navigation/'+page+'.json', 
						function(nav_json){
							x.pleft = nav_json.left
							x.pright = nav_json.right
							x.pup = nav_json.up
							x.pdown = nav_json.down
							var url = RES_URL+'vlo/'+x.lang+'/'+nav_json.vlo
							function check(){
								if(Konekti.vc('vlo') !== undefined ) Konekti.client['vlo'].setText(url)
								else setTimeout(check, 100)
							}
							check()	
						}
					)
				}
			}

			language(lang){
				if( lang != this.lang ) window.open(SERVER_URL+"/python/index.html?lang="+lang+"&page="+this.page,"_self")
			}

			left(){ if( this.pleft !== undefined ) this.select(this.pleft) }

			right(){ if( this.pright !== undefined) this.select(this.pright) }

			up(){
				if(this.pup=='/') window.open(SERVER_URL+"/index.html?lang="+this.lang,"_self")
				else if( this.pup !== undefined ) this.select(this.pup)
			}

			down(){ if( this.pdown !== undefined) this.select(this.pdown) }
		}

		function KonektiMain(){
			var lang = Konekti.dom.getUserLanguage()

			var callback = function(json){ 
				if(json===undefined || json===null){
					lang = 'es'
					Konekti.resource.JSON(RES_URL+'python/i18n/'+lang+'.json', callback)
				}else{
					var client = new KMain(lang)
					var toc = {'plugin':'toc', 'setup':[4, '', {'client':'client', 'method':'select'}, json.toc]}
					var btn=[
						{'plugin':'btn', 'setup':["left","fa-arrow-circle-o-left", '', {'client':'client'}, "w3-blue-grey", ""]},
						{'plugin':'btn', 'setup':["up","fa-arrow-circle-o-up", '', {'client':'client'}, "w3-blue-grey", ""]},
						{'plugin':'btn', 'setup':["down","fa-arrow-circle-o-down", '', {'client':'client'}, "w3-blue-grey", ""]},
						{'plugin':'btn', 'setup':["right","fa-arrow-circle-o-right", '', {'client':'client'}, "w3-blue-grey", ""]},
						{'plugin':'dropdown', 'setup':["language", "fa-language", "", 'w3-blue-grey', json.language, 'list', {
							'options':[
								{'id':'en', 'caption':"English"}, 
								{'id':'es','caption':"Espa√±ol"}], 					
							'onclick':{"client":'client', "method":"language"}
							}
						]}
					]
					var title = {'plugin':'header', 'setup':['title','', json.title, 3, 'w3-green w3-center']}
					var navbar = {'plugin':'navbar', 'setup':['navbar', 'w3-blue-grey', btn,'','']}			
					var control = {'plugin':'iframe', 'setup':['vlo', '100%', 'rest', '']}
					var main = {'plugin':'container', 'setup':['main-content','100%','100%', '', [title,navbar,control]]}
					Konekti.sidebar('root', '100%', '100%', toc, main)	

					Konekti.resize()

					var page = Konekti.dom.getURLSearchParam('page', 'home')

					client.select(page)
				}
			}

			Konekti.resource.JSON(RES_URL+'python/i18n/'+lang+'.json', callback)
			
        }
	</script>
</body>
</html>
